function h(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var Y={A:{args:["rx","ry","rotation","arc","sweep","ex","ey"]},a:{args:["rx","ry","rotation","arc","sweep","ex","ey"]},C:{args:["cx1","cy1","cx2","cy2","ex","ey"]},c:{args:["cx1","cy1","cx2","cy2","ex","ey"]},H:{args:["x"]},h:{args:["x"]},L:{args:["x","y"]},l:{args:["x","y"]},M:{args:["x","y"]},m:{args:["x","y"]},Q:{args:["cx","cy","ex","ey"]},q:{args:["cx","cy","ex","ey"]},S:{args:["cx","cy","ex","ey"]},s:{args:["cx","cy","ex","ey"]},T:{args:["ex","ey"]},t:{args:["ex","ey"]},V:{args:["y"]},v:{args:["y"]},z:{args:[]}};class u{constructor(){return h(this,"attr",(t,s)=>(this.attributes[t]=s,this)),h(this,"fill",t=>this.attr("fill",t)),h(this,"stroke",t=>this.attr("stroke",t)),h(this,"strokeWidth",t=>this.attr("stroke-width",t)),h(this,"style",t=>this.attr("style",t)),h(this,"m",(t,s)=>this.moveTo(t,s,!0)),h(this,"M",(t,s)=>this.moveTo(t,s)),h(this,"moveTo",(t,s,i=!1)=>(this.pathData.push(`${i?"m":"M"}${t} ${s}`),this)),h(this,"l",(t,s)=>this.lineTo(t,s,!0)),h(this,"L",(t,s)=>this.lineTo(t,s)),h(this,"lineTo",(t,s,i=!1)=>(this.pathData.push(`${i?"l":"L"}${t} ${s}`),this)),h(this,"H",t=>this.horizontalTo(t)),h(this,"h",t=>this.horizontalTo(t,!0)),h(this,"horizontalTo",(t,s=!1)=>(this.pathData.push(`${s?"h":"H"}${t}`),this)),h(this,"V",t=>this.verticalTo(t)),h(this,"v",t=>this.verticalTo(t,!0)),h(this,"verticalTo",(t,s=!1)=>(this.pathData.push(`${s?"v":"V"}${t}`),this)),h(this,"Q",(t,s,i,o)=>this.qCurve(t,s,i,o)),h(this,"q",(t,s,i,o)=>this.qCurve(t,s,i,o,!0)),h(this,"qCurve",(t,s,i,o,n=!1)=>(this.pathData.push(`${n?"q":"Q"}${t} ${s} ${i} ${o}`),this)),h(this,"T",(t,s)=>this.tCurveTo(t,s)),h(this,"t",(t,s)=>this.tCurveTo(t,s,!0)),h(this,"tCurveTo",(t,s,i=!1)=>(this.pathData.push(`${i?"t":"T"}${t} ${s}`),this)),h(this,"C",(t,s,i,o,n,r)=>this.cCurve(t,s,i,o,n,r)),h(this,"c",(t,s,i,o,n,r)=>this.cCurve(t,s,i,o,n,r,!0)),h(this,"cCurve",(t,s,i,o,n,r,a=!1)=>(this.pathData.push(`${a?"c":"C"}${t} ${s} ${i} ${o} ${n} ${r}`),this)),h(this,"S",(t,s,i,o)=>this.sCurveTo(t,s,i,o)),h(this,"s",(t,s,i,o)=>this.sCurveTo(t,s,i,o,!0)),h(this,"sCurveTo",(t,s,i,o,n=!1)=>(this.pathData.push(`${n?"s":"S"}${t} ${s} ${i} ${o}`),this)),h(this,"A",(t,s,i,o,n,r,a)=>this.arc(t,s,i,o,n,r,a)),h(this,"a",(t,s,i,o,n,r,a)=>this.arc(t,s,i,o,n,r,a,!0)),h(this,"arc",(t,s,i,o,n,r,a,c=!1)=>(this.pathData.push(`${c?"a":"A"}${t} ${s} ${i} ${o} ${n} ${r} ${a}`),this)),h(this,"down",t=>this.v(t)),h(this,"up",t=>this.v(-1*t)),h(this,"right",t=>this.h(t)),h(this,"left",t=>this.h(-1*t)),h(this,"close",()=>(this.pathData.push("z"),this)),h(this,"toArray",()=>this.pathData),h(this,"toString",()=>this.pathData.join("")),h(this,"toCommands",()=>this.pathData.map(t=>{const s=[t.substr(0,1)],i=t.substr(1);return i.length&&s.push(...i.split(" ").map(Number)),s})),h(this,"toAnnotatedCommands",()=>this.toCommands().map(t=>{const s=t.shift(),i=Y[s].args;return i.length?{fn:s,args:t.reduce((o,n,r)=>(o[i[r]]=n,o),{})}:{fn:s}})),h(this,"toElement",(t={})=>{const s={...this.attributes,...t},i=document.createElementNS("http://www.w3.org/2000/svg","path");return Object.keys(s).forEach(o=>{i.setAttribute(o,s[o])}),i.setAttribute("d",this.toString()),i}),this.pathData=[],this.attributes={},this}}h(u,"angleInRadians",e=>e*Math.PI/180),h(u,"polarToCartesian",(e,t,s,i)=>{const o=u.angleInRadians(i);return{x:e+s*Math.cos(o),y:t+s*Math.sin(o)}}),h(u,"clockwisePoint",(e,t,s,i)=>{const o=i-90;return u.polarToCartesian(e,t,s,o)}),h(u,"radialPoints",(e,t,s,i,o,n=1)=>{o=o||-.5*Math.PI,e=e||1e-10;const r=2*Math.PI*n/i,a=Array.from(Array(i>=0?i:0).keys()),c=Math.max(0,4-Math.floor(Math.log10(e)));return a.map((y,l)=>{const d=l*r+o;return[(t+e*Math.cos(d)).toFixed(c),(s+e*Math.sin(d)).toFixed(c)]})}),h(u,"positionByArray",(e,t,s,i)=>{const o=[],n=e/2;return t.forEach((r,a)=>{r.forEach((c,y)=>{c&&o.push({size:e,cx:y*e+n+s,cy:a*e+n+i,ri:a,ci:y,value:c})})}),o}),h(u,"macro",(e,t)=>{u.prototype[e]=t}),u.macro("rect",function(e,t,s,i,o=!0){return this.M(s-e/2,i-t/2).right(e).down(t).left(e).up(t),o&&this.M(s,i),this}),u.macro("square",function(e,t,s,i=!0){return this.rect(e,e,t,s,i)}),u.macro("roundedSquare",function(e,t,s,i,o=!0){return this.roundedRect(e,e,t,s,i,o)}),u.macro("roundedRect",function(e,t,s,i,o,n=!0){const r=o-t/2,a=i-e/2,c=a+e,y=r+t;let l=Math.min(s,e/2);l=l<0?0:l;let d=Math.min(s,t/2);d=d<0?0:d;const m=Math.max(e-2*l,0),M=Math.max(t-2*d,0);return this.M(a+l,r).right(m).A(l,d,0,0,1,c,r+d).down(M).A(l,d,0,0,1,c-l,y).left(m).A(l,d,0,0,1,a,y-d).up(M).A(l,d,0,0,1,a+l,r).M(a,r),n&&this.M(i,o),this}),u.macro("circle",function(e,t,s,i=!0){return this.ellipse(e,e,t,s,i)}),u.macro("ellipse",function(e,t,s,i,o=!0){const n=e/2,r=t/2;return this.M(s+n,i).A(n,r,0,0,1,s-n,i).A(n,r,0,0,1,s+n,i).close(),o&&this.M(s,i),this}),u.macro("isocube",function(e,t,s,i=!0){this.regPolygon(e,6,t,s,i);const o=this.constructor.radialPoints(0,t,s,6),n=this.constructor.radialPoints(e/2,t,s,6);return[1,3,5].forEach(r=>{this.M(o[r][0],o[r][1]).L(n[r][0],n[r][1])}),i&&this.M(t,s),this}),u.macro("kite",function(e,t,s,i,o,n=!0){s=s||parseInt(.33*t,10);const[r,a,c]=this.constructor.radialPoints(t/2,i,o,4),y=parseInt(r[1],10)+s,l=[r,[i-e/2,y],c,[i+e/2,y]];return this.polyline(l).close()}),u.macro("lens",function(e,t,s,i,o=!0){return this.M(s-e/2,i).Q(s,i-t,s+e/2,i).Q(s,i+t,s-e/2,i),o&&this.M(s,i),this}),u.macro("polyline",function(e,t=!1){const s=[...e],i=s.shift(),o=t?this.m:this.M,n=t?this.l:this.L;return o.apply(null,i),s.forEach(r=>{n.apply(null,r)}),this}),u.macro("polygon",function(e){return this.polyline(e).close(),this}),u.macro("regPolygon",function(e,t,s,i,o=!0){return this.polygon(this.constructor.radialPoints(e/2,s,i,t)),o&&this.M(s,i),this}),u.macro("polygram",function(e,t,s,i,o=2,n=!0){return this.polygon(this.constructor.radialPoints(e/2,s,i,t,null,o)),n&&this.M(s,i),this}),u.macro("radialLines",function(e,t,s,i,o,n=!0){const r=this.constructor.radialPoints(t/2,i,o,s),a=this.constructor.radialPoints(e/2,i,o,s);return r.forEach((c,y)=>{this.M(c[0],c[1]).L(a[y][0],a[y][1])}),n&&this.M(i,o),this}),u.macro("star",function(e,t,s,i,o,n=!0){const r=t/2,a=e/2,c=360/(2*s),y=Array.from({length:2*s}).map((l,d)=>{let m=d%2==0?a:r,M=c*d;const{x:v,y:L}=this.constructor.clockwisePoint(i,o,m,M,n);return[v,L]});return this.polygon(y),n&&this.M(i,o),this}),u.macro("triangle",function(e,t,s,i=!0){const o=Math.sqrt(3),n=[t,s-o/3*e],r=[t-e/2,s+o/6*e],a=[t+e/2,s+o/6*e];return this.polygon([n,r,a]),i&&this.M(t,s),this}),u.macro("sector",function(e,t,s,i,o,n=!0){const r=s/2,a=this.constructor.clockwisePoint(e,t,r,o),c=this.constructor.clockwisePoint(e,t,r,i),y=o-i<=180?0:1;return this.M(a.x,a.y).A(r,r,0,y,0,c.x,c.y).L(e,t).L(a.x,a.y),n&&this.M(e,t),this}),u.macro("segment",function(e,t,s,i,o,n=!0){const r=s/2,a=this.constructor.clockwisePoint(e,t,r,o),c=this.constructor.clockwisePoint(e,t,r,i),y=o-i<=180?0:1;return this.M(a.x,a.y).A(r,r,0,y,0,c.x,c.y),n&&this.M(e,t),this}),u.macro("cross",function(e,t,s,i,o=!0){const n=s-e/2,r=n+e,a=i-t/2,c=a+t;return this.M(n,i).L(r,i).M(s,c).L(s,a),o&&this.M(s,i),this}),u.macro("symH",function(e,t,s,i,o=!0){const n=s-e/2,r=n+e,a=i-t/2,c=a+t;return this.M(n,a).L(n,c).M(n,i).L(r,i).M(r,a).L(r,c),o&&this.M(s,i),this}),u.macro("symI",function(e,t,s,i,o=!0){const n=s-e/2,r=n+e,a=i-t/2,c=a+t;return this.M(n,a).L(r,a).M(s,a).L(s,c).M(n,c).L(r,c),o&&this.M(s,i),this}),u.macro("symV",function(e,t,s,i,o=!0){const n=s-e/2,r=n+e,a=i-t/2,c=a+t;return this.M(n,a).L(s,c).L(r,a),o&&this.M(s,i),this}),u.macro("symX",function(e,t,s,i,o=!0){const n=s-e/2,r=n+e,a=i-t/2,c=a+t;return this.M(n,a).L(r,c).M(n,c).L(r,a),o&&this.M(s,i),this}),u.macro("omino",function(e,t,s,i,o=!1){return this.constructor.positionByArray(e,t,s,i).forEach((n,r,a)=>{const{cx:c,cy:y,ri:l,ci:d,size:m}=n,M=m/2,v=a.find(p=>p.ri===l&&p.ci===d-1),L=a.find(p=>p.ri===l&&p.ci===d+1),b=a.find(p=>p.ri===l-1&&p.ci===d),C=a.find(p=>p.ri===l+1&&p.ci===d),$=c-M,A=c+M,w=y-M,k=y+M;v&&!o||(this.M($,w),this.v(m)),L||(this.M(A,w),this.v(m)),b&&!o||(this.M($,w),this.h(m)),C||(this.M($,k),this.h(m))}),this});const T=document.querySelector.bind(document),Z=document.querySelectorAll.bind(document),q=document.createElement.bind(document),f=q("canvas"),x=f.getContext("2d");f.id="c";Z(".shape-button").forEach(e=>{e.addEventListener("click",()=>{T("#shape").value=e.dataset.shape})});const _=e=>{const t=q("video");return t.id="player",t.muted=!0,t.setAttribute("loop","true"),t.style.display="none",t.innerHTML+=`<source src="${e}" type="video/mp4" />`,t},tt=()=>{const e=_("/assets/exp/video/ddd.mp4"),t=T("#container");t&&(t.appendChild(e),t.appendChild(f),e.addEventListener("loadedmetadata",function(){setInterval(st.bind(this),10)},!1),e.play())},st=()=>{const e=T("#player");if(!(e instanceof HTMLVideoElement)||!(f instanceof HTMLCanvasElement))return;var t=e.videoWidth,s=e.videoHeight;f.width=800,f.height=480;const i=400;x.clearRect(0,0,t,s);const o=T("#shape").value;let n;const r=f.width/2,a=f.height/2;switch(o){case"star":n=new u().star(450,200,5,f.width/2,f.height/2);break;case"ellipse":n=new u().ellipse(i,480,r,a);break;case"regPolygon":n=new u().regPolygon(450,5,r,a);break;case"x":const l=u.radialPoints(225,r,a,8),[d,m]=l[0],[M,v]=l[1],[L,b]=l[2],[C,$]=l[3],[A,w]=l[4],[k,p]=l[5],[I,S]=l[6],[H,z]=l[7],g=u.radialPoints(50,r,a,8),[D,E]=g[0],[Q,R]=g[1],[V,j]=g[2],[W,B]=g[3],[F,N]=g[4],[O,X]=g[5],[G,J]=g[6],[K,U]=g[7];n=new u().M(D,E).L(d,m).L(M,v).L(Q,R).L(V,j).L(L,b).L(C,$).L(W,B).L(F,N).L(A,w).L(k,p).L(O,X).L(G,J).L(I,S).L(H,z).L(K,U).L(D,E);break;case"pie":const P=2;n=new u().sector(r,a-P,375,0,45).sector(r,a,375,45,165).sector(r-P,a,375,165,270).sector(r-P,a-P,375,270,360);break}const c=new Path2D(n.toString());x.translate(r,a);const y=e.currentTime*Math.PI*3/e.duration;x.rotate(y),x.translate(-r,-a),x.clip(c),x.setTransform(1,0,0,1,0,0),x.drawImage(e,0,0,f.width,f.height)};tt();
