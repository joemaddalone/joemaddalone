function h(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var k={A:{args:["rx","ry","rotation","arc","sweep","ex","ey"]},a:{args:["rx","ry","rotation","arc","sweep","ex","ey"]},C:{args:["cx1","cy1","cx2","cy2","ex","ey"]},c:{args:["cx1","cy1","cx2","cy2","ex","ey"]},H:{args:["x"]},h:{args:["x"]},L:{args:["x","y"]},l:{args:["x","y"]},M:{args:["x","y"]},m:{args:["x","y"]},Q:{args:["cx","cy","ex","ey"]},q:{args:["cx","cy","ex","ey"]},S:{args:["cx","cy","ex","ey"]},s:{args:["cx","cy","ex","ey"]},T:{args:["ex","ey"]},t:{args:["ex","ey"]},V:{args:["y"]},v:{args:["y"]},z:{args:[]}};class u{constructor(){return h(this,"attr",(t,s)=>(this.attributes[t]=s,this)),h(this,"fill",t=>this.attr("fill",t)),h(this,"stroke",t=>this.attr("stroke",t)),h(this,"strokeWidth",t=>this.attr("stroke-width",t)),h(this,"style",t=>this.attr("style",t)),h(this,"m",(t,s)=>this.moveTo(t,s,!0)),h(this,"M",(t,s)=>this.moveTo(t,s)),h(this,"moveTo",(t,s,i=!1)=>(this.pathData.push(`${i?"m":"M"}${t} ${s}`),this)),h(this,"l",(t,s)=>this.lineTo(t,s,!0)),h(this,"L",(t,s)=>this.lineTo(t,s)),h(this,"lineTo",(t,s,i=!1)=>(this.pathData.push(`${i?"l":"L"}${t} ${s}`),this)),h(this,"H",t=>this.horizontalTo(t)),h(this,"h",t=>this.horizontalTo(t,!0)),h(this,"horizontalTo",(t,s=!1)=>(this.pathData.push(`${s?"h":"H"}${t}`),this)),h(this,"V",t=>this.verticalTo(t)),h(this,"v",t=>this.verticalTo(t,!0)),h(this,"verticalTo",(t,s=!1)=>(this.pathData.push(`${s?"v":"V"}${t}`),this)),h(this,"Q",(t,s,i,r)=>this.qCurve(t,s,i,r)),h(this,"q",(t,s,i,r)=>this.qCurve(t,s,i,r,!0)),h(this,"qCurve",(t,s,i,r,o=!1)=>(this.pathData.push(`${o?"q":"Q"}${t} ${s} ${i} ${r}`),this)),h(this,"T",(t,s)=>this.tCurveTo(t,s)),h(this,"t",(t,s)=>this.tCurveTo(t,s,!0)),h(this,"tCurveTo",(t,s,i=!1)=>(this.pathData.push(`${i?"t":"T"}${t} ${s}`),this)),h(this,"C",(t,s,i,r,o,n)=>this.cCurve(t,s,i,r,o,n)),h(this,"c",(t,s,i,r,o,n)=>this.cCurve(t,s,i,r,o,n,!0)),h(this,"cCurve",(t,s,i,r,o,n,a=!1)=>(this.pathData.push(`${a?"c":"C"}${t} ${s} ${i} ${r} ${o} ${n}`),this)),h(this,"S",(t,s,i,r)=>this.sCurveTo(t,s,i,r)),h(this,"s",(t,s,i,r)=>this.sCurveTo(t,s,i,r,!0)),h(this,"sCurveTo",(t,s,i,r,o=!1)=>(this.pathData.push(`${o?"s":"S"}${t} ${s} ${i} ${r}`),this)),h(this,"A",(t,s,i,r,o,n,a)=>this.arc(t,s,i,r,o,n,a)),h(this,"a",(t,s,i,r,o,n,a)=>this.arc(t,s,i,r,o,n,a,!0)),h(this,"arc",(t,s,i,r,o,n,a,c=!1)=>(this.pathData.push(`${c?"a":"A"}${t} ${s} ${i} ${r} ${o} ${n} ${a}`),this)),h(this,"down",t=>this.v(t)),h(this,"up",t=>this.v(-1*t)),h(this,"right",t=>this.h(t)),h(this,"left",t=>this.h(-1*t)),h(this,"close",()=>(this.pathData.push("z"),this)),h(this,"toArray",()=>this.pathData),h(this,"toString",()=>this.pathData.join("")),h(this,"toCommands",()=>this.pathData.map(t=>{const s=[t.substr(0,1)],i=t.substr(1);return i.length&&s.push(...i.split(" ").map(Number)),s})),h(this,"toAnnotatedCommands",()=>this.toCommands().map(t=>{const s=t.shift(),i=k[s].args;return i.length?{fn:s,args:t.reduce((r,o,n)=>(r[i[n]]=o,r),{})}:{fn:s}})),h(this,"toElement",(t={})=>{const s={...this.attributes,...t},i=document.createElementNS("http://www.w3.org/2000/svg","path");return Object.keys(s).forEach(r=>{i.setAttribute(r,s[r])}),i.setAttribute("d",this.toString()),i}),this.pathData=[],this.attributes={},this}}h(u,"angleInRadians",e=>e*Math.PI/180),h(u,"polarToCartesian",(e,t,s,i)=>{const r=u.angleInRadians(i);return{x:e+s*Math.cos(r),y:t+s*Math.sin(r)}}),h(u,"clockwisePoint",(e,t,s,i)=>{const r=i-90;return u.polarToCartesian(e,t,s,r)}),h(u,"radialPoints",(e,t,s,i,r,o=1)=>{r=r||-.5*Math.PI,e=e||1e-10;const n=2*Math.PI*o/i,a=Array.from(Array(i>=0?i:0).keys()),c=Math.max(0,4-Math.floor(Math.log10(e)));return a.map((p,l)=>{const d=l*n+r;return[(t+e*Math.cos(d)).toFixed(c),(s+e*Math.sin(d)).toFixed(c)]})}),h(u,"positionByArray",(e,t,s,i)=>{const r=[],o=e/2;return t.forEach((n,a)=>{n.forEach((c,p)=>{c&&r.push({size:e,cx:p*e+o+s,cy:a*e+o+i,ri:a,ci:p,value:c})})}),r}),h(u,"macro",(e,t)=>{u.prototype[e]=t}),u.macro("rect",function(e,t,s,i,r=!0){return this.M(s-e/2,i-t/2).right(e).down(t).left(e).up(t),r&&this.M(s,i),this}),u.macro("square",function(e,t,s,i=!0){return this.rect(e,e,t,s,i)}),u.macro("roundedSquare",function(e,t,s,i,r=!0){return this.roundedRect(e,e,t,s,i,r)}),u.macro("roundedRect",function(e,t,s,i,r,o=!0){const n=r-t/2,a=i-e/2,c=a+e,p=n+t;let l=Math.min(s,e/2);l=l<0?0:l;let d=Math.min(s,t/2);d=d<0?0:d;const y=Math.max(e-2*l,0),m=Math.max(t-2*d,0);return this.M(a+l,n).right(y).A(l,d,0,0,1,c,n+d).down(m).A(l,d,0,0,1,c-l,p).left(y).A(l,d,0,0,1,a,p-d).up(m).A(l,d,0,0,1,a+l,n).M(a,n),o&&this.M(i,r),this}),u.macro("circle",function(e,t,s,i=!0){return this.ellipse(e,e,t,s,i)}),u.macro("ellipse",function(e,t,s,i,r=!0){const o=e/2,n=t/2;return this.M(s+o,i).A(o,n,0,0,1,s-o,i).A(o,n,0,0,1,s+o,i).close(),r&&this.M(s,i),this}),u.macro("isocube",function(e,t,s,i=!0){this.regPolygon(e,6,t,s,i);const r=this.constructor.radialPoints(0,t,s,6),o=this.constructor.radialPoints(e/2,t,s,6);return[1,3,5].forEach(n=>{this.M(r[n][0],r[n][1]).L(o[n][0],o[n][1])}),i&&this.M(t,s),this}),u.macro("kite",function(e,t,s,i,r,o=!0){s=s||parseInt(.33*t,10);const[n,a,c]=this.constructor.radialPoints(t/2,i,r,4),p=parseInt(n[1],10)+s,l=[n,[i-e/2,p],c,[i+e/2,p]];return this.polyline(l).close()}),u.macro("lens",function(e,t,s,i,r=!0){return this.M(s-e/2,i).Q(s,i-t,s+e/2,i).Q(s,i+t,s-e/2,i),r&&this.M(s,i),this}),u.macro("polyline",function(e,t=!1){const s=[...e],i=s.shift(),r=t?this.m:this.M,o=t?this.l:this.L;return r.apply(null,i),s.forEach(n=>{o.apply(null,n)}),this}),u.macro("polygon",function(e){return this.polyline(e).close(),this}),u.macro("regPolygon",function(e,t,s,i,r=!0){return this.polygon(this.constructor.radialPoints(e/2,s,i,t)),r&&this.M(s,i),this}),u.macro("polygram",function(e,t,s,i,r=2,o=!0){return this.polygon(this.constructor.radialPoints(e/2,s,i,t,null,r)),o&&this.M(s,i),this}),u.macro("radialLines",function(e,t,s,i,r,o=!0){const n=this.constructor.radialPoints(t/2,i,r,s),a=this.constructor.radialPoints(e/2,i,r,s);return n.forEach((c,p)=>{this.M(c[0],c[1]).L(a[p][0],a[p][1])}),o&&this.M(i,r),this}),u.macro("star",function(e,t,s,i,r,o=!0){const n=t/2,a=e/2,c=360/(2*s),p=Array.from({length:2*s}).map((l,d)=>{let y=d%2==0?a:n,m=c*d;const{x,y:$}=this.constructor.clockwisePoint(i,r,y,m,o);return[x,$]});return this.polygon(p),o&&this.M(i,r),this}),u.macro("triangle",function(e,t,s,i=!0){const r=Math.sqrt(3),o=[t,s-r/3*e],n=[t-e/2,s+r/6*e],a=[t+e/2,s+r/6*e];return this.polygon([o,n,a]),i&&this.M(t,s),this}),u.macro("sector",function(e,t,s,i,r,o=!0){const n=s/2,a=this.constructor.clockwisePoint(e,t,n,r),c=this.constructor.clockwisePoint(e,t,n,i),p=r-i<=180?0:1;return this.M(a.x,a.y).A(n,n,0,p,0,c.x,c.y).L(e,t).L(a.x,a.y),o&&this.M(e,t),this}),u.macro("segment",function(e,t,s,i,r,o=!0){const n=s/2,a=this.constructor.clockwisePoint(e,t,n,r),c=this.constructor.clockwisePoint(e,t,n,i),p=r-i<=180?0:1;return this.M(a.x,a.y).A(n,n,0,p,0,c.x,c.y),o&&this.M(e,t),this}),u.macro("cross",function(e,t,s,i,r=!0){const o=s-e/2,n=o+e,a=i-t/2,c=a+t;return this.M(o,i).L(n,i).M(s,c).L(s,a),r&&this.M(s,i),this}),u.macro("symH",function(e,t,s,i,r=!0){const o=s-e/2,n=o+e,a=i-t/2,c=a+t;return this.M(o,a).L(o,c).M(o,i).L(n,i).M(n,a).L(n,c),r&&this.M(s,i),this}),u.macro("symI",function(e,t,s,i,r=!0){const o=s-e/2,n=o+e,a=i-t/2,c=a+t;return this.M(o,a).L(n,a).M(s,a).L(s,c).M(o,c).L(n,c),r&&this.M(s,i),this}),u.macro("symV",function(e,t,s,i,r=!0){const o=s-e/2,n=o+e,a=i-t/2,c=a+t;return this.M(o,a).L(s,c).L(n,a),r&&this.M(s,i),this}),u.macro("symX",function(e,t,s,i,r=!0){const o=s-e/2,n=o+e,a=i-t/2,c=a+t;return this.M(o,a).L(n,c).M(o,c).L(n,a),r&&this.M(s,i),this}),u.macro("omino",function(e,t,s,i,r=!1){return this.constructor.positionByArray(e,t,s,i).forEach((o,n,a)=>{const{cx:c,cy:p,ri:l,ci:d,size:y}=o,m=y/2,x=a.find(M=>M.ri===l&&M.ci===d-1),$=a.find(M=>M.ri===l&&M.ci===d+1),T=a.find(M=>M.ri===l-1&&M.ci===d),C=a.find(M=>M.ri===l+1&&M.ci===d),w=c-m,b=c+m,L=p-m,A=p+m;x&&!r||(this.M(w,L),this.v(y)),$||(this.M(b,L),this.v(y)),T&&!r||(this.M(w,L),this.h(y)),C||(this.M(w,A),this.h(y))}),this});const v=document.querySelector.bind(document),D=document.querySelectorAll.bind(document),P=document.createElement.bind(document),f=P("canvas"),g=f.getContext("2d");f.id="c";D(".shape-button").forEach(e=>{e.addEventListener("click",()=>{v("#shape").value=e.dataset.shape})});const E=e=>{const t=P("video");return t.id="player",t.muted=!0,t.setAttribute("loop","true"),t.style.display="none",t.innerHTML+=`<source src="${e}" type="video/mp4" />`,t},q=()=>{const e=E("/assets/exp/video/ddd.mp4"),t=v("#container");t&&(t.appendChild(e),t.appendChild(f),e.addEventListener("loadedmetadata",function(){setInterval(I.bind(this),10)},!1),e.play())},I=()=>{const e=v("#player");if(!(e instanceof HTMLVideoElement)||!(f instanceof HTMLCanvasElement))return;var t=e.videoWidth,s=e.videoHeight;f.width=800,f.height=480;const i=400;g.clearRect(0,0,t,s);const r=v("#shape").value;let o;const n=f.width/2,a=f.height/2;switch(r){case"star":o=new u().star(450,200,5,f.width/2,f.height/2);break;case"ellipse":o=new u().ellipse(i,480,n,a);break;case"regPolygon":o=new u().regPolygon(450,5,n,a);break;case"x":const l=8,d=u.radialPoints(225,n,a,l),y=u.radialPoints(0,n,a,l);o=new u().M(y[0][0],y[0][1]);for(let m=0;m<l;m+=2)o=o.L(d[m][0],d[m][1]).L(d[m+1][0],d[m+1][1]).L(y[m+1][0],y[m+1][1]).L(y[(m+2)%l][0],y[(m+2)%l][1]);break}const c=new Path2D(o.toString());g.translate(n,a);const p=e.currentTime*Math.PI*3/e.duration;g.rotate(p),g.translate(-n,-a),g.clip(c),g.setTransform(1,0,0,1,0,0),g.drawImage(e,0,0,f.width,f.height)};q();
