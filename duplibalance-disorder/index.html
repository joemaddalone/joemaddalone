<!DOCTYPE html><html lang="en"> <head><meta charset="utf-8"><link rel="icon" type="image/x-icon" href="/assets/favicon.ico"><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v5.12.5"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="apple-touch-icon" sizes="57x57" href="/assets/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/tachyons/4.11.1/tachyons.min.css" integrity="sha512-d0v474klOFSF7qD9WDvyRxAvXaWSxCHDZdnBSZQjo8BpVr6vpjwAgqetpqkKP38DzlOzdVPaLVnzzW1Ba8wB9w==" crossorigin="anonymous"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.5.0/semantic.min.css"><link href="//unpkg.com/prismjs@1.20.0/themes/prism.css" rel="stylesheet"><title></title><style>.nav-links{width:100%;top:5rem;left:48px;background-color:#ff9776;display:none;margin:0}.nav-links a{display:block;text-align:center;padding:10px 0;text-decoration:none;font-size:1.2rem;font-weight:700;text-transform:uppercase}.nav-links a:hover,.nav-links a:focus{background-color:#ff9776}.expanded{display:unset}@media screen and (min-width: 636px){.nav-links{margin-left:5em;display:block;position:static;width:auto;background:none}.nav-links a{display:inline-block;padding:15px 20px}}html.dark{background-color:#0d0950;color:#fff}.dark .nav-links a{color:#fff}:root{--black: #000;--near-black: #111;--dark-gray: #333;--mid-gray: #555;--gray: #777;--silver: #999;--light-silver: #aaa;--moon-gray: #ccc;--light-gray: #eee;--near-white: #f8f8f8;--white: #fff;--transparent: transparent;--black-90: rgba(0, 0, 0, .9);--black-80: rgba(0, 0, 0, .8);--black-70: rgba(0, 0, 0, .7);--black-60: rgba(0, 0, 0, .6);--black-50: rgba(0, 0, 0, .5);--black-40: rgba(0, 0, 0, .4);--black-30: rgba(0, 0, 0, .3);--black-20: rgba(0, 0, 0, .2);--black-10: rgba(0, 0, 0, .1);--black-05: rgba(0, 0, 0, .05);--black-025: rgba(0, 0, 0, .025);--black-0125: rgba(0, 0, 0, .0125);--white-90: rgba(255, 255, 255, .9);--white-80: rgba(255, 255, 255, .8);--white-70: rgba(255, 255, 255, .7);--white-60: rgba(255, 255, 255, .6);--white-50: rgba(255, 255, 255, .5);--white-40: rgba(255, 255, 255, .4);--white-30: rgba(255, 255, 255, .3);--white-20: rgba(255, 255, 255, .2);--white-10: rgba(255, 255, 255, .1);--white-05: rgba(255, 255, 255, .05);--white-025: rgba(255, 255, 255, .025);--white-0125: rgba(255, 255, 255, .0125);--dark-red: #e7040f;--red: #ff4136;--light-red: #ff725c;--orange: #ff6300;--gold: #ffb700;--yellow: #ffd700;--light-yellow: #fbf1a9;--purple: #5e2ca5;--light-purple: #a463f2;--dark-purple: rebeccapurple;--dark-pink: #d5008f;--hot-pink: #ff41b4;--pink: #ff80cc;--light-pink: #ffa3d7;--dark-green: #137752;--green: #19a974;--light-green: #9eebcf;--navy: #001b44;--dark-blue: #00449e;--blue: #357edd;--light-blue: #96ccff;--lightest-blue: #cdecff;--washed-blue: #f6fffe;--washed-green: #e8fdf5;--washed-yellow: #fffceb;--washed-red: #ffdfdf}body,html{background-color:#eee;font-size:18px}header{font-size:75%;padding:25px 10px;margin:0 auto;max-width:800px;color:#222}header b{color:#222}footer{padding:15px 8px;font-size:75%;margin:20px auto;max-width:800px;border-top:1px dashed #222}.standard-article{margin:0 auto;padding:10px;max-width:800px;color:#222}.standard-article a{text-decoration:none}.standard-article a:hover{text-decoration:underline}.standard-article p{line-height:1.7;display:block}.standard-article pre{margin-bottom:15px;padding:1em;border-radius:.5em}.standard-article pre code{font-size:.8rem}.standard-article blockquote p{color:var(--black-60)}.standard-article hgroup{padding-left:16px;margin-bottom:16px;border-left:15px solid #222}.standard-article hgroup h1{margin-bottom:0}.standard-article hgroup p{margin:0;font-style:italic;color:#666}.postlist{margin:0;padding:4px}.postlist .postlist-item{display:flex;flex-direction:column;list-style-type:none;margin-top:15px}.postlist .postlist-item .postlist-date{font-size:1rem;padding-bottom:5px}.yt-embed{height:50vw;margin:1rem 0;max-height:25rem;width:100%}.resume-header{font-size:75%;padding:25px 10px;margin:0 auto;max-width:900px;color:#222}.resume-container{margin:0 auto;padding:10px;max-width:900px;color:#222}
</style></head> <body> <header class="flex items-center justify-between bb"> <b><a href="/writes/">I write stuff. sometimes.</a></b> <a href="/"> <img src="/assets/favicon-32x32.png" width="32" height="32" alt=""> </a> </header>  <div class="standard-article">  <hgroup>
	<h1>DupliBalance Disorder</h1>
	<p>Dumb app + automation I did today</p>
</hgroup>
<p>I hate most financial snapshot apps… eventually.</p>
<p>So, I started off using PersonalCapital, then it turned into Empower. After that, I switched to Mint, and now it’s Credit Karma. The funny thing is, all these apps seem to suffer from what I call “DupliBalance Disorder.” You know, the classic scenario where you check your financial data, and suddenly, an account decides to clone itself, messing up all your totals. You try to fix it by kicking out the extra account, but whoops, it ends up deleting both. Add it back, and now you’ve got three.</p>
<p>Honestly, I don’t need the whole everyday budgeting and tracking thing and other apps do a great job of that. I just wanted something that could give me real-time info on my money situation. I’m mostly looking for my bottom line. (cash + investments) - debt.</p>
<p>So…</p>
<h2 id="access">Access</h2>
<p>I signed up for <a href="https://plaid.com/pricing/">Plaid’s free plan</a>.  Then used <a href="https://github.com/kevinschaich/mintable">mintable</a> to easily get the keys I needed.</p>
<p>Now I have a <code>config</code> like this,</p>
<pre class="astro-code snazzy-light" style="background-color:#FAFBFC;color:#565869; overflow-x: auto;" tabindex="0" data-language="js"><code><span class="line"><span style="color:#ADB1C2">{</span></span>
<span class="line"><span style="color:#ADB1C2">	"</span><span style="color:#CF9C00">plaid</span><span style="color:#ADB1C2">"</span><span style="color:#565869">: </span><span style="color:#ADB1C2">{</span></span>
<span class="line"><span style="color:#ADB1C2">		"</span><span style="color:#11658F">PLAID-CLIENT-ID</span><span style="color:#ADB1C2">"</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> "</span><span style="color:#CF9C00">xoxoxoxoxoxoxoxoxo</span><span style="color:#ADB1C2">"</span><span style="color:#ADB1C2">,</span></span>
<span class="line"><span style="color:#ADB1C2">		"</span><span style="color:#11658F">PLAID-SECRET</span><span style="color:#ADB1C2">"</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> "</span><span style="color:#CF9C00">xoxoxoxoxoxoxoxoxo</span><span style="color:#ADB1C2">"</span><span style="color:#ADB1C2">,</span></span>
<span class="line"><span style="color:#ADB1C2">		"</span><span style="color:#11658F">Plaid-Version</span><span style="color:#ADB1C2">"</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> "</span><span style="color:#CF9C00">nnnn-nn-nn</span><span style="color:#ADB1C2">"</span></span>
<span class="line"><span style="color:#ADB1C2">	},</span></span>
<span class="line"><span style="color:#ADB1C2">	"</span><span style="color:#CF9C00">accounts</span><span style="color:#ADB1C2">"</span><span style="color:#565869">: </span><span style="color:#ADB1C2">{</span></span>
<span class="line"><span style="color:#ADB1C2">		"</span><span style="color:#11658F">institution_1</span><span style="color:#ADB1C2">"</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> "</span><span style="color:#CF9C00">access-development-xoxoxoxoxoxoxoxoxo</span><span style="color:#ADB1C2">"</span><span style="color:#ADB1C2">,</span></span>
<span class="line"><span style="color:#ADB1C2">		"</span><span style="color:#11658F">institution_2</span><span style="color:#ADB1C2">"</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> "</span><span style="color:#CF9C00">access-development-xoxoxoxoxoxoxoxoxo</span><span style="color:#ADB1C2">"</span></span>
<span class="line"><span style="color:#ADB1C2">	}</span></span>
<span class="line"><span style="color:#ADB1C2">}</span></span></code></pre>
<h2 id="plaid">Plaid</h2>
<p>The plaid npm package is great, but I really only need to do a few things, so adding my own wrapper seemed like a good idea.</p>
<pre class="astro-code snazzy-light" style="background-color:#FAFBFC;color:#565869; overflow-x: auto;" tabindex="0" data-language="js"><code><span class="line"><span style="color:#ADB1C2">// api.mjs</span></span>
<span class="line"><span style="color:#F767BB">import</span><span style="color:#ADB1C2"> {</span><span style="color:#565869"> Configuration</span><span style="color:#ADB1C2">,</span><span style="color:#565869"> PlaidApi</span><span style="color:#ADB1C2">,</span><span style="color:#565869"> PlaidEnvironments </span><span style="color:#ADB1C2">}</span><span style="color:#F767BB"> from</span><span style="color:#ADB1C2"> "</span><span style="color:#CF9C00">plaid</span><span style="color:#ADB1C2">"</span><span style="color:#ADB1C2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F767BB">export</span><span style="color:#F767BB"> default</span><span style="color:#F767BB"> class</span><span style="color:#13BBB7"> Api</span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#F767BB">  constructor</span><span style="color:#ADB1C2">(</span><span style="color:#565869">config</span><span style="color:#ADB1C2">)</span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#13BBB7">    this</span><span style="color:#ADB1C2">.</span><span style="color:#565869">plaidClient </span><span style="color:#ADB1C2">=</span><span style="color:#2DAE58"> null</span><span style="color:#ADB1C2">;</span></span>
<span class="line"><span style="color:#13BBB7">    this</span><span style="color:#ADB1C2">.</span><span style="color:#565869">config </span><span style="color:#ADB1C2">=</span><span style="color:#565869"> config</span><span style="color:#ADB1C2">;</span></span>
<span class="line"><span style="color:#13BBB7">    this</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">makeClient</span><span style="color:#ADB1C2">();</span></span>
<span class="line"><span style="color:#ADB1C2">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#09A1ED">  makeClient</span><span style="color:#ADB1C2">()</span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#F767BB">    if</span><span style="color:#ADB1C2"> (!</span><span style="color:#13BBB7">this</span><span style="color:#ADB1C2">.</span><span style="color:#565869">plaidClient</span><span style="color:#ADB1C2">)</span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#F767BB">      const</span><span style="color:#565869"> configuration </span><span style="color:#ADB1C2">=</span><span style="color:#F767BB"> new</span><span style="color:#09A1ED"> Configuration</span><span style="color:#ADB1C2">({</span></span>
<span class="line"><span style="color:#11658F">        basePath</span><span style="color:#ADB1C2">:</span><span style="color:#565869"> PlaidEnvironments</span><span style="color:#ADB1C2">.</span><span style="color:#565869">development</span><span style="color:#ADB1C2">,</span></span>
<span class="line"><span style="color:#11658F">        baseOptions</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#11658F">          headers</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> {</span><span style="color:#ADB1C2"> ...</span><span style="color:#13BBB7">this</span><span style="color:#ADB1C2">.</span><span style="color:#565869">config</span><span style="color:#ADB1C2">.</span><span style="color:#565869">plaid </span><span style="color:#ADB1C2">},</span></span>
<span class="line"><span style="color:#ADB1C2">        },</span></span>
<span class="line"><span style="color:#ADB1C2">      });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#13BBB7">      this</span><span style="color:#ADB1C2">.</span><span style="color:#565869">plaidClient </span><span style="color:#ADB1C2">=</span><span style="color:#F767BB"> new</span><span style="color:#09A1ED"> PlaidApi</span><span style="color:#ADB1C2">(</span><span style="color:#565869">configuration</span><span style="color:#ADB1C2">);</span></span>
<span class="line"><span style="color:#ADB1C2">    }</span></span>
<span class="line"><span style="color:#ADB1C2">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F767BB">  async</span><span style="color:#09A1ED"> balance</span><span style="color:#ADB1C2">(</span><span style="color:#565869">access_token</span><span style="color:#ADB1C2">)</span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#F767BB">    try</span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#F767BB">      const</span><span style="color:#565869"> accounts_response </span><span style="color:#ADB1C2">=</span><span style="color:#F767BB"> await</span><span style="color:#13BBB7"> this</span><span style="color:#ADB1C2">.</span><span style="color:#565869">plaidClient</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">accountsBalanceGet</span><span style="color:#ADB1C2">({</span></span>
<span class="line"><span style="color:#565869">        access_token</span><span style="color:#ADB1C2">,</span></span>
<span class="line"><span style="color:#ADB1C2">      });</span></span>
<span class="line"><span style="color:#F767BB">      return</span><span style="color:#565869"> accounts_response</span><span style="color:#ADB1C2">;</span></span>
<span class="line"><span style="color:#ADB1C2">    }</span><span style="color:#F767BB"> catch</span><span style="color:#ADB1C2"> (</span><span style="color:#565869">error</span><span style="color:#ADB1C2">)</span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#ADB1C2">      // console.error(error);</span></span>
<span class="line"><span style="color:#ADB1C2">    }</span></span>
<span class="line"><span style="color:#ADB1C2">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F767BB">  async</span><span style="color:#09A1ED"> balances</span><span style="color:#ADB1C2">()</span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#F767BB">	const</span><span style="color:#565869"> accounts </span><span style="color:#ADB1C2">=</span><span style="color:#13BBB7"> this</span><span style="color:#ADB1C2">.</span><span style="color:#565869">config</span><span style="color:#ADB1C2">.</span><span style="color:#565869">accounts</span></span>
<span class="line"><span style="color:#F767BB">    const</span><span style="color:#565869"> accountBalances </span><span style="color:#ADB1C2">=</span><span style="color:#565869"> Object</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">keys</span><span style="color:#ADB1C2">(</span><span style="color:#565869">accounts</span><span style="color:#ADB1C2">).</span><span style="color:#09A1ED">map</span><span style="color:#ADB1C2">(</span><span style="color:#F767BB">async</span><span style="color:#ADB1C2"> (</span><span style="color:#565869">key</span><span style="color:#ADB1C2">)</span><span style="color:#ADB1C2"> =></span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#F767BB">      const</span><span style="color:#565869"> acc </span><span style="color:#ADB1C2">=</span><span style="color:#F767BB"> await</span><span style="color:#13BBB7"> this</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">balance</span><span style="color:#ADB1C2">(</span><span style="color:#565869">accounts</span><span style="color:#ADB1C2">[</span><span style="color:#565869">key</span><span style="color:#ADB1C2">]);</span></span>
<span class="line"><span style="color:#F767BB">      return</span><span style="color:#565869"> acc</span><span style="color:#ADB1C2">.</span><span style="color:#565869">data</span><span style="color:#ADB1C2">.</span><span style="color:#565869">accounts</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">map</span><span style="color:#ADB1C2">((</span><span style="color:#565869">a</span><span style="color:#ADB1C2">)</span><span style="color:#ADB1C2"> =></span><span style="color:#ADB1C2"> ({</span><span style="color:#ADB1C2"> ...</span><span style="color:#565869">a</span><span style="color:#ADB1C2">,</span><span style="color:#565869"> key </span><span style="color:#ADB1C2">}));</span></span>
<span class="line"><span style="color:#ADB1C2">    });</span></span>
<span class="line"><span style="color:#F767BB">    return</span><span style="color:#13BBB7"> Promise</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">allSettled</span><span style="color:#ADB1C2">(</span><span style="color:#565869">accountBalances</span><span style="color:#ADB1C2">);</span></span>
<span class="line"><span style="color:#ADB1C2">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADB1C2">  // The part I really care about.</span></span>
<span class="line"><span style="color:#F767BB">  async</span><span style="color:#09A1ED"> formattedBalances</span><span style="color:#ADB1C2">()</span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#F767BB">	const</span><span style="color:#565869"> accountBalances </span><span style="color:#ADB1C2">=</span><span style="color:#F767BB"> await</span><span style="color:#13BBB7"> this</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">balances</span><span style="color:#ADB1C2">();</span></span>
<span class="line"><span style="color:#F767BB">	const</span><span style="color:#565869"> payload </span><span style="color:#ADB1C2">=</span><span style="color:#565869"> accountBalances</span></span>
<span class="line"><span style="color:#ADB1C2">	  .</span><span style="color:#09A1ED">filter</span><span style="color:#ADB1C2">((</span><span style="color:#565869">o</span><span style="color:#ADB1C2">)</span><span style="color:#ADB1C2"> =></span><span style="color:#565869"> o</span><span style="color:#ADB1C2">.</span><span style="color:#565869">status </span><span style="color:#ADB1C2">===</span><span style="color:#ADB1C2"> "</span><span style="color:#CF9C00">fulfilled</span><span style="color:#ADB1C2">"</span><span style="color:#ADB1C2">)</span></span>
<span class="line"><span style="color:#ADB1C2">	  .</span><span style="color:#09A1ED">map</span><span style="color:#ADB1C2">((</span><span style="color:#565869">o</span><span style="color:#ADB1C2">)</span><span style="color:#ADB1C2"> =></span><span style="color:#565869"> o</span><span style="color:#ADB1C2">.</span><span style="color:#565869">value</span><span style="color:#ADB1C2">)</span></span>
<span class="line"><span style="color:#ADB1C2">	  .</span><span style="color:#09A1ED">flat</span><span style="color:#ADB1C2">(</span><span style="color:#2DAE58">Infinity</span><span style="color:#ADB1C2">)</span></span>
<span class="line"><span style="color:#ADB1C2">	  .</span><span style="color:#09A1ED">map</span><span style="color:#ADB1C2">((</span><span style="color:#565869">a</span><span style="color:#ADB1C2">)</span><span style="color:#ADB1C2"> =></span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#F767BB">		return</span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#11658F">		  title</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> `${</span><span style="color:#565869">a</span><span style="color:#ADB1C2">.</span><span style="color:#565869">key</span><span style="color:#ADB1C2">}</span><span style="color:#CF9C00"> (</span><span style="color:#ADB1C2">${</span><span style="color:#565869">a</span><span style="color:#ADB1C2">.</span><span style="color:#565869">name</span><span style="color:#ADB1C2">}</span><span style="color:#CF9C00">)</span><span style="color:#ADB1C2">`</span><span style="color:#ADB1C2">,</span></span>
<span class="line"><span style="color:#11658F">		  value</span><span style="color:#ADB1C2">:</span><span style="color:#565869"> a</span><span style="color:#ADB1C2">.</span><span style="color:#565869">type </span><span style="color:#ADB1C2">===</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">credit</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2"> ?</span><span style="color:#ADB1C2"> ~~</span><span style="color:#565869">a</span><span style="color:#ADB1C2">.</span><span style="color:#565869">balances</span><span style="color:#ADB1C2">.</span><span style="color:#565869">current</span><span style="color:#ADB1C2">*-</span><span style="color:#FF5C57">1</span><span style="color:#ADB1C2"> :</span><span style="color:#565869"> a</span><span style="color:#ADB1C2">.</span><span style="color:#565869">balances</span><span style="color:#ADB1C2">.</span><span style="color:#565869">available </span><span style="color:#ADB1C2">||</span><span style="color:#565869"> a</span><span style="color:#ADB1C2">.</span><span style="color:#565869">balances</span><span style="color:#ADB1C2">.</span><span style="color:#565869">current</span><span style="color:#ADB1C2">,</span></span>
<span class="line"><span style="color:#ADB1C2">		};</span></span>
<span class="line"><span style="color:#ADB1C2">	  });</span></span>
<span class="line"><span style="color:#F767BB">	return</span><span style="color:#565869"> payload</span><span style="color:#ADB1C2">;</span></span>
<span class="line"><span style="color:#ADB1C2">  }</span></span>
<span class="line"><span style="color:#ADB1C2">}</span></span></code></pre>
<h2 id="indexmjs-so-far">index.mjs so far…</h2>
<pre class="astro-code snazzy-light" style="background-color:#FAFBFC;color:#565869; overflow-x: auto;" tabindex="0" data-language="js"><code><span class="line"><span style="color:#F767BB">import</span><span style="color:#565869"> config </span><span style="color:#F767BB">from</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">./config.mjs</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">;</span></span>
<span class="line"><span style="color:#F767BB">import</span><span style="color:#565869"> Api </span><span style="color:#F767BB">from</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">./api.mjs</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">;</span></span>
<span class="line"><span style="color:#F767BB">const</span><span style="color:#565869"> api </span><span style="color:#ADB1C2">=</span><span style="color:#F767BB"> new</span><span style="color:#09A1ED"> Api</span><span style="color:#ADB1C2">(</span><span style="color:#565869">config</span><span style="color:#ADB1C2">);</span></span>
<span class="line"><span style="color:#F767BB">const</span><span style="color:#565869"> data </span><span style="color:#ADB1C2">=</span><span style="color:#F767BB"> await</span><span style="color:#565869"> api</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">formattedBalances</span><span style="color:#ADB1C2">(</span><span style="color:#565869">config</span><span style="color:#ADB1C2">);</span></span>
<span class="line"><span style="color:#565869">console</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">log</span><span style="color:#ADB1C2">(</span><span style="color:#565869">JSON</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">stringify</span><span style="color:#ADB1C2">(</span><span style="color:#565869">data</span><span style="color:#ADB1C2">,</span><span style="color:#2DAE58"> null</span><span style="color:#ADB1C2">,</span><span style="color:#FF5C57"> 2</span><span style="color:#ADB1C2">));</span></span></code></pre>
<h2 id="result">Result</h2>
<pre class="astro-code snazzy-light" style="background-color:#FAFBFC;color:#565869; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#ADB1C2">[</span></span>
<span class="line"><span style="color:#565869">  {</span></span>
<span class="line"><span style="color:#ADB1C2">    "</span><span style="color:#CF9C00">title</span><span style="color:#ADB1C2">"</span><span style="color:#565869">: </span><span style="color:#ADB1C2">"</span><span style="color:#CF9C00">institution_1 (****nnnn)</span><span style="color:#ADB1C2">"</span><span style="color:#565869">,</span></span>
<span class="line"><span style="color:#ADB1C2">    "</span><span style="color:#CF9C00">value</span><span style="color:#ADB1C2">"</span><span style="color:#565869">: </span><span style="color:#FF5C57">1.97</span></span>
<span class="line"><span style="color:#565869">  },</span></span>
<span class="line"><span style="color:#565869">  {</span></span>
<span class="line"><span style="color:#ADB1C2">    "</span><span style="color:#CF9C00">title</span><span style="color:#ADB1C2">"</span><span style="color:#565869">: </span><span style="color:#ADB1C2">"</span><span style="color:#CF9C00">institution_1 (**nnnn)</span><span style="color:#ADB1C2">"</span><span style="color:#565869">,</span></span>
<span class="line"><span style="color:#ADB1C2">    "</span><span style="color:#CF9C00">value</span><span style="color:#ADB1C2">"</span><span style="color:#565869">: </span><span style="color:#FF5C57">2.69</span></span>
<span class="line"><span style="color:#565869">  },</span></span>
<span class="line"><span style="color:#565869">  {</span></span>
<span class="line"><span style="color:#ADB1C2">    "</span><span style="color:#CF9C00">title</span><span style="color:#ADB1C2">"</span><span style="color:#565869">: </span><span style="color:#ADB1C2">"</span><span style="color:#CF9C00">institution_2 (High Yield CD 12-Month)</span><span style="color:#ADB1C2">"</span><span style="color:#565869">,</span></span>
<span class="line"><span style="color:#ADB1C2">    "</span><span style="color:#CF9C00">value</span><span style="color:#ADB1C2">"</span><span style="color:#565869">: </span><span style="color:#FF5C57">100</span></span>
<span class="line"><span style="color:#565869">  },</span></span>
<span class="line"><span style="color:#565869">  {</span></span>
<span class="line"><span style="color:#ADB1C2">    "</span><span style="color:#CF9C00">title</span><span style="color:#ADB1C2">"</span><span style="color:#565869">: </span><span style="color:#ADB1C2">"</span><span style="color:#CF9C00">institution_2 (Spending Account)</span><span style="color:#ADB1C2">"</span><span style="color:#565869">,</span></span>
<span class="line"><span style="color:#ADB1C2">    "</span><span style="color:#CF9C00">value</span><span style="color:#ADB1C2">"</span><span style="color:#565869">: </span><span style="color:#FF5C57">50.46</span></span>
<span class="line"><span style="color:#565869">  },</span></span>
<span class="line"><span style="color:#565869">  {</span></span>
<span class="line"><span style="color:#ADB1C2">    "</span><span style="color:#CF9C00">title</span><span style="color:#ADB1C2">"</span><span style="color:#565869">: </span><span style="color:#ADB1C2">"</span><span style="color:#CF9C00">institution_2 (Savings Account)</span><span style="color:#ADB1C2">"</span><span style="color:#565869">,</span></span>
<span class="line"><span style="color:#ADB1C2">    "</span><span style="color:#CF9C00">value</span><span style="color:#ADB1C2">"</span><span style="color:#565869">: </span><span style="color:#FF5C57">1500.58</span></span>
<span class="line"><span style="color:#565869">  }</span></span>
<span class="line"><span style="color:#ADB1C2">]</span></span></code></pre>
<h2 id="make-things-a-tad-bit-prettier">Make things a tad bit prettier.</h2>
<p>Having the data in JSON is fine and all, but I kinda want something I can scan quickly as currency.  A total would be nice too.</p>
<pre class="astro-code snazzy-light" style="background-color:#FAFBFC;color:#565869; overflow-x: auto;" tabindex="0" data-language="js"><code><span class="line"><span style="color:#ADB1C2">/// formatPlaid.mjs</span></span>
<span class="line"><span style="color:#F767BB">const</span><span style="color:#09A1ED"> formatPlaid</span><span style="color:#ADB1C2"> =</span><span style="color:#ADB1C2"> (</span><span style="color:#565869">data</span><span style="color:#ADB1C2">)</span><span style="color:#ADB1C2"> =></span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#F767BB">  const</span><span style="color:#565869"> formatter </span><span style="color:#ADB1C2">=</span><span style="color:#F767BB"> new</span><span style="color:#565869"> Intl</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">NumberFormat</span><span style="color:#ADB1C2">(</span><span style="color:#ADB1C2">'</span><span style="color:#CF9C00">en-US</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">,</span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#11658F">	style</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">currency</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">,</span></span>
<span class="line"><span style="color:#11658F">	currency</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">USD</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">,</span></span>
<span class="line"><span style="color:#ADB1C2">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F767BB">  const</span><span style="color:#565869"> fields </span><span style="color:#ADB1C2">=</span><span style="color:#565869"> data</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">map</span><span style="color:#ADB1C2">(</span><span style="color:#565869">d </span><span style="color:#ADB1C2">=></span><span style="color:#ADB1C2"> ({</span></span>
<span class="line"><span style="color:#ADB1C2">	...</span><span style="color:#565869">d</span><span style="color:#ADB1C2">,</span></span>
<span class="line"><span style="color:#ADB1C2">	'</span><span style="color:#11658F">value</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">:</span><span style="color:#565869"> formatter</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">format</span><span style="color:#ADB1C2">(</span><span style="color:#565869">d</span><span style="color:#ADB1C2">.</span><span style="color:#565869">value</span><span style="color:#ADB1C2">),</span></span>
<span class="line"><span style="color:#ADB1C2">  }));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#565869">  fields</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">push</span><span style="color:#ADB1C2">({</span></span>
<span class="line"><span style="color:#ADB1C2">	'</span><span style="color:#11658F">title</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">Total</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">,</span></span>
<span class="line"><span style="color:#ADB1C2">	'</span><span style="color:#11658F">value</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">:</span><span style="color:#565869"> formatter</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">format</span><span style="color:#ADB1C2">(</span><span style="color:#565869">data</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">reduce</span><span style="color:#ADB1C2">((</span><span style="color:#565869">a</span><span style="color:#ADB1C2">,</span><span style="color:#565869"> b</span><span style="color:#ADB1C2">)</span><span style="color:#ADB1C2"> =></span><span style="color:#565869"> a </span><span style="color:#ADB1C2">+</span><span style="color:#565869"> b</span><span style="color:#ADB1C2">.</span><span style="color:#565869">value</span><span style="color:#ADB1C2">,</span><span style="color:#FF5C57"> 0</span><span style="color:#ADB1C2">)),</span></span>
<span class="line"><span style="color:#ADB1C2">  })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F767BB">  return</span><span style="color:#565869"> fields</span><span style="color:#ADB1C2">;</span></span>
<span class="line"><span style="color:#ADB1C2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F767BB">export</span><span style="color:#F767BB"> default</span><span style="color:#565869"> formatPlaid</span><span style="color:#ADB1C2">;</span></span></code></pre>
<h2 id="indexmjs-so-far-1">index.mjs so far…</h2>
<pre class="astro-code snazzy-light" style="background-color:#FAFBFC;color:#565869; overflow-x: auto;" tabindex="0" data-language="js"><code><span class="line"><span style="color:#F767BB">import</span><span style="color:#565869"> config </span><span style="color:#F767BB">from</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">./config.mjs</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">;</span></span>
<span class="line"><span style="color:#F767BB">import</span><span style="color:#565869"> Api </span><span style="color:#F767BB">from</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">./api.mjs</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">;</span></span>
<span class="line"><span style="color:#F767BB">import</span><span style="color:#565869"> formatPlaid </span><span style="color:#F767BB">from</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">./formatPlaid.mjs</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">;</span></span>
<span class="line"><span style="color:#F767BB">const</span><span style="color:#565869"> api </span><span style="color:#ADB1C2">=</span><span style="color:#F767BB"> new</span><span style="color:#09A1ED"> Api</span><span style="color:#ADB1C2">(</span><span style="color:#565869">config</span><span style="color:#ADB1C2">);</span></span>
<span class="line"><span style="color:#F767BB">const</span><span style="color:#565869"> data </span><span style="color:#ADB1C2">=</span><span style="color:#F767BB"> await</span><span style="color:#565869"> api</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">formattedBalances</span><span style="color:#ADB1C2">(</span><span style="color:#565869">config</span><span style="color:#ADB1C2">);</span></span>
<span class="line"><span style="color:#565869">console</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">log</span><span style="color:#ADB1C2">(</span><span style="color:#09A1ED">formatPlaid</span><span style="color:#ADB1C2">(</span><span style="color:#565869">data</span><span style="color:#ADB1C2">))</span></span></code></pre>
<h2 id="result-1">Result</h2>
<pre class="astro-code snazzy-light" style="background-color:#FAFBFC;color:#565869; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#ADB1C2">[</span></span>
<span class="line"><span style="color:#565869">  { title: </span><span style="color:#ADB1C2">'</span><span style="color:#CF9C00">institution_1 (****nnnn)</span><span style="color:#ADB1C2">'</span><span style="color:#565869">, value: </span><span style="color:#ADB1C2">'</span><span style="color:#CF9C00">$1.97</span><span style="color:#ADB1C2">'</span><span style="color:#565869"> },</span></span>
<span class="line"><span style="color:#565869">  { title: </span><span style="color:#ADB1C2">'</span><span style="color:#CF9C00">institution_1 (**nnnn)</span><span style="color:#ADB1C2">'</span><span style="color:#565869">, value: </span><span style="color:#ADB1C2">'</span><span style="color:#CF9C00">$2.69</span><span style="color:#ADB1C2">'</span><span style="color:#565869"> },</span></span>
<span class="line"><span style="color:#565869">  { title: </span><span style="color:#ADB1C2">'</span><span style="color:#CF9C00">institution_2 (High Yield CD 12-Month)</span><span style="color:#ADB1C2">'</span><span style="color:#565869">, value: </span><span style="color:#ADB1C2">'</span><span style="color:#CF9C00">$100.00</span><span style="color:#ADB1C2">'</span><span style="color:#565869"> },</span></span>
<span class="line"><span style="color:#565869">  { title: </span><span style="color:#ADB1C2">'</span><span style="color:#CF9C00">institution_2 (Spending Account)</span><span style="color:#ADB1C2">'</span><span style="color:#565869">, value: </span><span style="color:#ADB1C2">'</span><span style="color:#CF9C00">$50.46</span><span style="color:#ADB1C2">'</span><span style="color:#565869"> },</span></span>
<span class="line"><span style="color:#565869">  { title: </span><span style="color:#ADB1C2">'</span><span style="color:#CF9C00">institution_2 (Savings Account)</span><span style="color:#ADB1C2">'</span><span style="color:#565869">, value: </span><span style="color:#ADB1C2">'</span><span style="color:#CF9C00">$1,500.58</span><span style="color:#ADB1C2">'</span><span style="color:#565869"> },</span></span>
<span class="line"><span style="color:#565869">  { title: </span><span style="color:#ADB1C2">'</span><span style="color:#CF9C00">Total</span><span style="color:#ADB1C2">'</span><span style="color:#565869">, value: </span><span style="color:#ADB1C2">'</span><span style="color:#CF9C00">$1,655.70</span><span style="color:#ADB1C2">'</span><span style="color:#565869"> }</span></span>
<span class="line"><span style="color:#ADB1C2">]</span></span></code></pre>
<h2 id="slack">Slack</h2>
<p>I wanted to send this to my own slack channel so I followed the code <a href="https://blog.nodeswat.com/simple-node-js-and-slack-webhook-integration-d87c95aa9600">explained here</a>.</p>
<p>And here we go…</p>
<pre class="astro-code snazzy-light" style="background-color:#FAFBFC;color:#565869; overflow-x: auto;" tabindex="0" data-language="js"><code><span class="line"><span style="color:#F767BB">import</span><span style="color:#565869"> https </span><span style="color:#F767BB">from</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">https</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">;</span></span>
<span class="line"><span style="color:#F767BB">const</span><span style="color:#565869"> hookUrl </span><span style="color:#ADB1C2">=</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">https://hooks.slack.com/services/nnn/nnn/nnn</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F767BB">function</span><span style="color:#09A1ED"> sendSlackMessage</span><span style="color:#ADB1C2">(</span><span style="color:#565869">fields</span><span style="color:#ADB1C2">)</span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#F767BB">  const</span><span style="color:#565869"> total </span><span style="color:#ADB1C2">=</span><span style="color:#565869"> fields</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">pop</span><span style="color:#ADB1C2">()</span></span>
<span class="line"><span style="color:#F767BB">  const</span><span style="color:#565869"> userAccountNotification </span><span style="color:#ADB1C2">=</span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#ADB1C2">	'</span><span style="color:#11658F">username</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">Fin notifier</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">,</span></span>
<span class="line"><span style="color:#ADB1C2">	'</span><span style="color:#11658F">text</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">Here is your fin update</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">,</span></span>
<span class="line"><span style="color:#ADB1C2">	'</span><span style="color:#11658F">attachments</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> [{</span></span>
<span class="line"><span style="color:#ADB1C2">	  '</span><span style="color:#11658F">color</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">#2eb886</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">,</span></span>
<span class="line"><span style="color:#ADB1C2">	  '</span><span style="color:#11658F">fields</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">:</span><span style="color:#565869"> fields</span></span>
<span class="line"><span style="color:#ADB1C2">  },</span></span>
<span class="line"><span style="color:#ADB1C2">  {</span></span>
<span class="line"><span style="color:#ADB1C2">    '</span><span style="color:#11658F">color</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">#ffff00</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">,</span></span>
<span class="line"><span style="color:#ADB1C2">    '</span><span style="color:#11658F">fields</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> [</span><span style="color:#565869">total</span><span style="color:#ADB1C2">]</span></span>
<span class="line"><span style="color:#ADB1C2">  }]</span></span>
<span class="line"><span style="color:#ADB1C2">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F767BB">  return</span><span style="color:#F767BB"> new</span><span style="color:#13BBB7"> Promise</span><span style="color:#ADB1C2">((</span><span style="color:#565869">resolve</span><span style="color:#ADB1C2">,</span><span style="color:#565869"> reject</span><span style="color:#ADB1C2">)</span><span style="color:#ADB1C2"> =></span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#F767BB">    const</span><span style="color:#565869"> requestOptions </span><span style="color:#ADB1C2">=</span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#11658F">  	  method</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">POST</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">,</span></span>
<span class="line"><span style="color:#11658F">	  header</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#ADB1C2">  	    '</span><span style="color:#11658F">Content-Type</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">:</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">application/json</span><span style="color:#ADB1C2">'</span></span>
<span class="line"><span style="color:#ADB1C2">	  }</span></span>
<span class="line"><span style="color:#ADB1C2">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F767BB">    const</span><span style="color:#565869"> req </span><span style="color:#ADB1C2">=</span><span style="color:#565869"> https</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">request</span><span style="color:#ADB1C2">(</span><span style="color:#565869">hookUrl</span><span style="color:#ADB1C2">,</span><span style="color:#565869"> requestOptions</span><span style="color:#ADB1C2">,</span><span style="color:#ADB1C2"> (</span><span style="color:#565869">res</span><span style="color:#ADB1C2">)</span><span style="color:#ADB1C2"> =></span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#F767BB">      let</span><span style="color:#565869"> response </span><span style="color:#ADB1C2">=</span><span style="color:#ADB1C2"> ''</span><span style="color:#ADB1C2">;</span></span>
<span class="line"><span style="color:#565869">      res</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">on</span><span style="color:#ADB1C2">(</span><span style="color:#ADB1C2">'</span><span style="color:#CF9C00">data</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">,</span><span style="color:#ADB1C2"> (</span><span style="color:#565869">d</span><span style="color:#ADB1C2">)</span><span style="color:#ADB1C2"> =></span><span style="color:#ADB1C2"> {</span><span style="color:#565869"> response </span><span style="color:#ADB1C2">+=</span><span style="color:#565869"> d</span><span style="color:#ADB1C2">;</span><span style="color:#ADB1C2"> });</span></span>
<span class="line"><span style="color:#565869">      res</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">on</span><span style="color:#ADB1C2">(</span><span style="color:#ADB1C2">'</span><span style="color:#CF9C00">end</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">,</span><span style="color:#ADB1C2"> ()</span><span style="color:#ADB1C2"> =></span><span style="color:#ADB1C2"> {</span><span style="color:#09A1ED"> resolve</span><span style="color:#ADB1C2">(</span><span style="color:#565869">response</span><span style="color:#ADB1C2">);</span><span style="color:#ADB1C2"> })</span></span>
<span class="line"><span style="color:#ADB1C2">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#565869">    req</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">on</span><span style="color:#ADB1C2">(</span><span style="color:#ADB1C2">'</span><span style="color:#CF9C00">error</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">,</span><span style="color:#ADB1C2"> (</span><span style="color:#565869">e</span><span style="color:#ADB1C2">)</span><span style="color:#ADB1C2"> =></span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#09A1ED">      reject</span><span style="color:#ADB1C2">(</span><span style="color:#565869">e</span><span style="color:#ADB1C2">);</span></span>
<span class="line"><span style="color:#ADB1C2">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#565869">    req</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">write</span><span style="color:#ADB1C2">(</span><span style="color:#565869">JSON</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">stringify</span><span style="color:#ADB1C2">(</span><span style="color:#565869">userAccountNotification</span><span style="color:#ADB1C2">));</span></span>
<span class="line"><span style="color:#565869">    req</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">end</span><span style="color:#ADB1C2">();</span></span>
<span class="line"><span style="color:#ADB1C2">  });</span></span>
<span class="line"><span style="color:#ADB1C2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F767BB">export</span><span style="color:#F767BB"> default</span><span style="color:#565869"> sendSlackMessage</span><span style="color:#ADB1C2">;</span></span></code></pre>
<h2 id="indexmjs-so-far-2">index.mjs so far…</h2>
<pre class="astro-code snazzy-light" style="background-color:#FAFBFC;color:#565869; overflow-x: auto;" tabindex="0" data-language="js"><code><span class="line"><span style="color:#F767BB">import</span><span style="color:#565869"> config </span><span style="color:#F767BB">from</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">./config.mjs</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">;</span></span>
<span class="line"><span style="color:#F767BB">import</span><span style="color:#565869"> Api </span><span style="color:#F767BB">from</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">./api.mjs</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">;</span></span>
<span class="line"><span style="color:#F767BB">import</span><span style="color:#565869"> formatPlaid </span><span style="color:#F767BB">from</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">./formatPlaid.mjs</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">;</span></span>
<span class="line"><span style="color:#F767BB">import</span><span style="color:#565869"> sendSlackMessage </span><span style="color:#F767BB">from</span><span style="color:#ADB1C2"> '</span><span style="color:#CF9C00">./sendSlack.mjs</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">;</span></span>
<span class="line"><span style="color:#F767BB">const</span><span style="color:#565869"> api </span><span style="color:#ADB1C2">=</span><span style="color:#F767BB"> new</span><span style="color:#09A1ED"> Api</span><span style="color:#ADB1C2">(</span><span style="color:#565869">config</span><span style="color:#ADB1C2">);</span></span>
<span class="line"><span style="color:#F767BB">const</span><span style="color:#565869"> data </span><span style="color:#ADB1C2">=</span><span style="color:#F767BB"> await</span><span style="color:#565869"> api</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">formattedBalances</span><span style="color:#ADB1C2">(</span><span style="color:#565869">config</span><span style="color:#ADB1C2">);</span></span>
<span class="line"><span style="color:#F767BB">try</span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#F767BB">  const</span><span style="color:#565869"> slackResponse </span><span style="color:#ADB1C2">=</span><span style="color:#F767BB"> await</span><span style="color:#09A1ED"> sendSlackMessage</span><span style="color:#ADB1C2">(</span><span style="color:#09A1ED">formatPlaid</span><span style="color:#ADB1C2">(</span><span style="color:#565869">data</span><span style="color:#ADB1C2">));</span></span>
<span class="line"><span style="color:#565869">  console</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">log</span><span style="color:#ADB1C2">(</span><span style="color:#ADB1C2">'</span><span style="color:#CF9C00">Message response</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">,</span><span style="color:#565869"> slackResponse</span><span style="color:#ADB1C2">);</span></span>
<span class="line"><span style="color:#ADB1C2">}</span><span style="color:#F767BB"> catch</span><span style="color:#ADB1C2"> (</span><span style="color:#565869">e</span><span style="color:#ADB1C2">)</span><span style="color:#ADB1C2"> {</span></span>
<span class="line"><span style="color:#565869">  console</span><span style="color:#ADB1C2">.</span><span style="color:#09A1ED">error</span><span style="color:#ADB1C2">(</span><span style="color:#ADB1C2">'</span><span style="color:#CF9C00">There was a error with the request</span><span style="color:#ADB1C2">'</span><span style="color:#ADB1C2">,</span><span style="color:#565869"> e</span><span style="color:#ADB1C2">);</span></span>
<span class="line"><span style="color:#ADB1C2">}</span></span></code></pre>
<h2 id="result-2">Result</h2>
<div class="ui large bordered image ma2">
<p><img alt="finslack" loading="lazy" decoding="async" fetchpriority="auto" width="909" height="593" src="/_astro/finSlack.DUn8T2_c_1qeWiL.webp" ></p>
</div>
<h2 id="next-up">Next up</h2>
<p>I got this running on a cron schedule in <a href="https://github.com/OliveTin/OliveTin">OliveTin</a>.  I explain it a bit <a href="/olivetin-node/">here</a>:</p>  </div>  <footer class="flex justify-between"> <div>I'm Joe Maddalone</div> <div><i>This is not a blog, these pages are changed all the time.</i></div> </footer> </body></html>