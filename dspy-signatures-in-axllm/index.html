<!DOCTYPE html><html lang="en"> <head><meta charset="utf-8"><link rel="icon" type="image/x-icon" href="/assets/favicon.ico"><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v5.12.5"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="apple-touch-icon" sizes="57x57" href="/assets/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link href="//unpkg.com/prismjs@1.20.0/themes/prism.css" rel="stylesheet"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.1/src/regular/style.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.1/src/fill/style.css"><title></title><link rel="stylesheet" href="/_astro/_slug_.BCJeLTLa.css"><style>lite-youtube>iframe{all:unset!important;width:100%!important;height:100%!important;position:absolute!important;inset:0!important;border:0!important}
</style><style>lite-youtube{background-color:#000;position:relative;display:block;contain:content;background-position:center center;background-size:cover;cursor:pointer;max-width:720px}lite-youtube:before{content:attr(data-title);display:block;position:absolute;top:0;background-image:linear-gradient(180deg,#000000ab,#0000008a 14%,#00000026 54%,#0000000d 72%,#0000 94%);height:99px;width:100%;font-family:YouTube Noto,Roboto,Arial,Helvetica,sans-serif;color:#eee;text-shadow:0 0 2px rgba(0,0,0,.5);font-size:18px;padding:25px 20px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;box-sizing:border-box}lite-youtube:hover:before{color:#fff}lite-youtube:after{content:"";display:block;padding-bottom:56.25%}lite-youtube>iframe{width:100%;height:100%;position:absolute;top:0;left:0;border:0}lite-youtube>.lty-playbtn{display:block;width:100%;height:100%;background:no-repeat center/68px 48px;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 48"><path d="M66.52 7.74c-.78-2.93-2.49-5.41-5.42-6.19C55.79.13 34 0 34 0S12.21.13 6.9 1.55c-2.93.78-4.63 3.26-5.42 6.19C.06 13.05 0 24 0 24s.06 10.95 1.48 16.26c.78 2.93 2.49 5.41 5.42 6.19C12.21 47.87 34 48 34 48s21.79-.13 27.1-1.55c2.93-.78 4.64-3.26 5.42-6.19C67.94 34.95 68 24 68 24s-.06-10.95-1.48-16.26z" fill="red"/><path d="M45 24 27 14v20" fill="white"/></svg>');position:absolute;cursor:pointer;z-index:1;filter:grayscale(100%);transition:filter .1s cubic-bezier(0,0,.2,1);border:0}lite-youtube:hover>.lty-playbtn,lite-youtube .lty-playbtn:focus{filter:none}lite-youtube.lyt-activated{cursor:unset}lite-youtube.lyt-activated:before,lite-youtube.lyt-activated>.lty-playbtn{opacity:0;pointer-events:none}.lyt-visually-hidden{clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}
</style></head> <body> <div class="sticky top-0 z-50 bg-white/80 shadow-md"> <nav class="flex items-center justify-between text-black h-12"> <a class="mt1 ml-1" href="/"> <img src="/assets/favicon-32x32.png" width="32" height="32" alt=""> </a> </nav> </div>  <div class="content-container section-spacing"> <div class="prose
	prose-invert
  prose-h1:font-bold prose-h1:text-xl
	prose-body:text-black prose-body:text-base
	prose-headings:text-black
	prose-p:text-black
	prose-code:text-black
	prose-code:bg-inherit
	prose-code:font-thin
	prose-code:text-xs
	prose-code:italic
	prose-code:before:content-none
	prose-code:after:content-none
	prose-ul:list-disc prose-ul:pl-4
	prose-strong:text-black
	prose-ruby:text-black
	prose-li:text-black">   <meta charset="utf-8"/>
<hgroup><h1>DSPy Signatures</h1><p>DSPy signatures in ax-llm.</p></hgroup>
<div class="pt-6"><lite-youtube videoid="GepX6R6LHgM" style="background-image: url('https://i.ytimg.com/vi/GepX6R6LHgM/hqdefault.jpg');"> <a href="https://youtube.com/watch?v=GepX6R6LHgM" class="lty-playbtn"> <span class="lyt-visually-hidden">Play</span> </a> </lite-youtube> <script type="module">class i extends HTMLElement{connectedCallback(){this.videoId=this.getAttribute("videoid");let e=this.querySelector(".lty-playbtn");if(this.playLabel=e&&e.textContent.trim()||this.getAttribute("playlabel")||"Play",this.dataset.title=this.getAttribute("title")||"",this.style.backgroundImage||(this.style.backgroundImage=`url("https://i.ytimg.com/vi/${this.videoId}/hqdefault.jpg")`,this.upgradePosterImage()),e||(e=document.createElement("button"),e.type="button",e.classList.add("lty-playbtn"),this.append(e)),!e.textContent){const t=document.createElement("span");t.className="lyt-visually-hidden",t.textContent=this.playLabel,e.append(t)}this.addNoscriptIframe(),e.nodeName==="A"&&(e.removeAttribute("href"),e.setAttribute("tabindex","0"),e.setAttribute("role","button"),e.addEventListener("keydown",t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),this.activate())})),this.addEventListener("pointerover",i.warmConnections,{once:!0}),this.addEventListener("focusin",i.warmConnections,{once:!0}),this.addEventListener("click",this.activate),this.needsYTApi=this.hasAttribute("js-api")||navigator.vendor.includes("Apple")||navigator.userAgent.includes("Mobi")}static addPrefetch(e,t,a){const r=document.createElement("link");r.rel=e,r.href=t,a&&(r.as=a),document.head.append(r)}static warmConnections(){i.preconnected||(i.addPrefetch("preconnect","https://www.youtube-nocookie.com"),i.addPrefetch("preconnect","https://www.google.com"),i.addPrefetch("preconnect","https://googleads.g.doubleclick.net"),i.addPrefetch("preconnect","https://static.doubleclick.net"),i.preconnected=!0)}fetchYTPlayerApi(){window.YT||window.YT&&window.YT.Player||(this.ytApiPromise=new Promise((e,t)=>{var a=document.createElement("script");a.src="https://www.youtube.com/iframe_api",a.async=!0,a.onload=r=>{YT.ready(e)},a.onerror=t,this.append(a)}))}async getYTPlayer(){return this.playerPromise||await this.activate(),this.playerPromise}async addYTPlayerIframe(){this.fetchYTPlayerApi(),await this.ytApiPromise;const e=document.createElement("div");this.append(e);const t=Object.fromEntries(this.getParams().entries());this.playerPromise=new Promise(a=>{let r=new YT.Player(e,{width:"100%",videoId:this.videoId,playerVars:t,events:{onReady:n=>{n.target.playVideo(),a(r)}}})})}addNoscriptIframe(){const e=this.createBasicIframe(),t=document.createElement("noscript");t.innerHTML=e.outerHTML,this.append(t)}getParams(){const e=new URLSearchParams(this.getAttribute("params")||[]);return e.append("autoplay","1"),e.append("playsinline","1"),e}async activate(){if(this.classList.contains("lyt-activated"))return;if(this.classList.add("lyt-activated"),this.needsYTApi)return this.addYTPlayerIframe(this.getParams());const e=this.createBasicIframe();this.append(e),e.focus()}createBasicIframe(){const e=document.createElement("iframe");return e.width=560,e.height=315,e.title=this.playLabel,e.allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",e.allowFullscreen=!0,e.src=`https://www.youtube-nocookie.com/embed/${encodeURIComponent(this.videoId)}?${this.getParams().toString()}`,e}upgradePosterImage(){setTimeout(()=>{const e=`https://i.ytimg.com/vi_webp/${this.videoId}/sddefault.webp`,t=new Image;t.fetchPriority="low",t.referrerpolicy="origin",t.src=e,t.onload=a=>{a.target.naturalHeight==90&&a.target.naturalWidth==120||(this.style.backgroundImage=`url("${e}")`)}},100)}}customElements.define("lite-youtube",i);</script> </div>
<h2 id="the-problem-with-prompts">The problem with prompts</h2>
<p>Here is an example of a prompt for identifying topics in a given text.</p>
<div class="expressive-code"><link rel="stylesheet" href="/_astro/ec.4dupk.css"/><script type="module" src="/_astro/ec.p1z7b.js"></script><figure class="frame"><figcaption class="header"></figcaption><pre data-language="js"><code><div class="ec-line"><div class="code"><span style="--0:#A2447B">const</span><span style="--0:#565869"> prompt </span><span style="--0:#646670">=</span><span style="--0:#565869"> </span><span style="--0:#646670">`</span></div></div><div class="ec-line"><div class="code"><span style="--0:#816100">Analyze the text.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#816100">Return a list of topics and the sentiment of the text.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#816100">Format your response as JSON with keys: sentiment, topics</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#816100">Review: </span><span style="--0:#646670">${</span><span style="--0:#565869">review</span><span style="--0:#646670">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#646670">`</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="const prompt = `Analyze the text.Return a list of topics and the sentiment of the text.Format your response as JSON with keys: sentiment, topicsReview: ${review}`"><div></div></button></div></figure></div>
<p>And here is a code example I ran:</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#A2447B">import</span><span style="--0:#565869"> ollama </span><span style="--0:#A2447B">from</span><span style="--0:#565869"> </span><span style="--0:#646670">&#39;</span><span style="--0:#816100">ollama</span><span style="--0:#646670">&#39;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#A2447B">const</span><span style="--0:#565869"> system </span><span style="--0:#646670">=</span><span style="--0:#565869"> </span><span style="--0:#646670">`</span><span style="--0:#816100">Analyze the text.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#816100">Return a list of topics and the sentiment of the text.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#816100">Format your response as JSON with keys: sentiment, topics</span><span style="--0:#646670">`</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#A2447B">const</span><span style="--0:#565869"> review </span><span style="--0:#646670">=</span><span style="--0:#565869"> </span><span style="--0:#646670">`</span></div></div><div class="ec-line"><div class="code"><span style="--0:#816100">I purchased a Widget from Amazon. Shipping was delayed.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#816100">I was displeased and will not purchase again.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#646670">`</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#A2447B">const</span><span style="--0:#565869"> response </span><span style="--0:#646670">=</span><span style="--0:#565869"> </span><span style="--0:#A2447B">await</span><span style="--0:#565869"> ollama</span><span style="--0:#646670">.</span><span style="--0:#066C9F">chat</span><span style="--0:#646670">({</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#11658F">model</span><span style="--0:#646670">:</span><span style="--0:#565869"> </span><span style="--0:#646670">&#39;</span><span style="--0:#816100">gpt-oss:latest</span><span style="--0:#646670">&#39;</span><span style="--0:#646670">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#11658F">messages</span><span style="--0:#646670">:</span><span style="--0:#565869"> </span><span style="--0:#646670">[</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#646670">{</span><span style="--0:#565869"> </span><span style="--0:#11658F">role</span><span style="--0:#646670">:</span><span style="--0:#565869"> </span><span style="--0:#646670">&#39;</span><span style="--0:#816100">system</span><span style="--0:#646670">&#39;</span><span style="--0:#646670">,</span><span style="--0:#565869"> </span><span style="--0:#11658F">content</span><span style="--0:#646670">:</span><span style="--0:#565869"> system </span><span style="--0:#646670">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#646670">{</span><span style="--0:#565869"> </span><span style="--0:#11658F">role</span><span style="--0:#646670">:</span><span style="--0:#565869"> </span><span style="--0:#646670">&#39;</span><span style="--0:#816100">user</span><span style="--0:#646670">&#39;</span><span style="--0:#646670">,</span><span style="--0:#565869"> </span><span style="--0:#11658F">content</span><span style="--0:#646670">:</span><span style="--0:#565869"> review </span><span style="--0:#646670">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#646670">],</span></div></div><div class="ec-line"><div class="code"><span style="--0:#646670">})</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">console</span><span style="--0:#646670">.</span><span style="--0:#066C9F">log</span><span style="--0:#646670">(</span><span style="--0:#565869">JSON</span><span style="--0:#646670">.</span><span style="--0:#066C9F">parse</span><span style="--0:#646670">(</span><span style="--0:#565869">response</span><span style="--0:#646670">.</span><span style="--0:#565869">message</span><span style="--0:#646670">.</span><span style="--0:#565869">content</span><span style="--0:#646670">))</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import ollama from 'ollama'const system = `Analyze the text.Return a list of topics and the sentiment of the text.Format your response as JSON with keys: sentiment, topics`const review = `I purchased a Widget from Amazon. Shipping was delayed.I was displeased and will not purchase again.`const response = await ollama.chat({  model: 'gpt-oss:latest',  messages: [    { role: 'system', content: system },    { role: 'user', content: review }  ],})console.log(JSON.parse(response.message.content))"><div></div></button></div></figure></div>
<p>This is the actual result with gpt:oss (including the ```json …)</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="js"><code><div class="ec-line"><div class="code"><span style="--0:#646670">```</span><span style="--0:#816100">json</span></div></div><div class="ec-line"><div class="code"><span style="--0:#816100">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#816100">  </span></span><span style="--0:#816100">&quot;sentiment&quot;: &quot;negative&quot;,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#816100">  </span></span><span style="--0:#816100">&quot;topics&quot;: [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#816100">    </span></span><span style="--0:#816100">&quot;purchase&quot;,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#816100">    </span></span><span style="--0:#816100">&quot;Amazon&quot;,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#816100">    </span></span><span style="--0:#816100">&quot;shipping delay&quot;,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#816100">    </span></span><span style="--0:#816100">&quot;displeasure&quot;,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#816100">    </span></span><span style="--0:#816100">...</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="```json{  &#34;sentiment&#34;: &#34;negative&#34;,  &#34;topics&#34;: [    &#34;purchase&#34;,    &#34;Amazon&#34;,    &#34;shipping delay&#34;,    &#34;displeasure&#34;,    ..."><div></div></button></div></figure></div>
<p>So of course we get:</p>
<div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#066C9F">SyntaxError:</span><span style="--0:#565869"> </span><span style="--0:#816100">JSON</span><span style="--0:#565869"> </span><span style="--0:#816100">Parse</span><span style="--0:#565869"> </span><span style="--0:#816100">error:</span><span style="--0:#565869"> </span><span style="--0:#816100">Unrecognized</span><span style="--0:#565869"> </span><span style="--0:#816100">token</span><span style="--0:#565869"> </span><span style="--0:#646670">&#39;</span><span style="--0:#816100">`</span><span style="--0:#646670">&#39;</span><span style="--0:#565869"> </span><span style="--0:#816100">at</span><span style="--0:#565869"> </span><span style="--0:#816100">/....ts:17:18</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="SyntaxError: JSON Parse error: Unrecognized token '`' at /....ts:17:18"><div></div></button></div></figure></div>
<p>And now we can futz around with our prompt or the output… or not.</p>
<h2 id="enter-dspy-signatures">Enter DSPy signatures</h2>
<p>DSPy signatures are a structured way to define the expected inputs and outputs for language models.
t it;s simplest it’s a typed input and a typed output delimited by <code>-&gt;</code></p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#565869">input:type -&gt; output:type</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="input:type -> output:type"><div></div></button></div></figure></div>
<p>Multiple inputs or outputs can be comma delimited, so in our case:</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#565869">review:string =&gt; sentiment:string, topics:string[]</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="review:string => sentiment:string, topics:string[]"><div></div></button></div></figure></div>
<p>Each field can also be followed by a description</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#565869">review:string &quot;User review&quot; -&gt;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">sentiment:string &quot;Sentiment of review&quot;,</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">topics:string[] &quot;Main topics discussed&quot;</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="review:string &#34;User review&#34; ->sentiment:string &#34;Sentiment of review&#34;,topics:string[] &#34;Main topics discussed&#34;"><div></div></button></div></figure></div>
<p>And finally we can provide an enum for something like sentiment using a “class” type.</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#565869">review:string &quot;User review&quot; -&gt;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">sentiment:class &quot;positive, neutral, negative&quot;,</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">topics:string[] &quot;Main topics discussed&quot;</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="review:string &#34;User review&#34; ->sentiment:class &#34;positive, neutral, negative&#34;,topics:string[] &#34;Main topics discussed&#34;"><div></div></button></div></figure></div>
<h2 id="ax-llm-dspy-for-typescript">Ax-llm (DSPy for TypeScript)</h2>
<p><a href="https://axllm.dev/">Ax-llm</a> allows us to use DSPy in (and for) Typescript.</p>
<div class="expressive-code"><figure class="frame has-title"><figcaption class="header"><span class="title">Dspy+Ollama in Ax</span></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#A2447B">import</span><span style="--0:#565869"> </span><span style="--0:#646670">{</span><span style="--0:#565869"> ai</span><span style="--0:#646670">,</span><span style="--0:#565869"> ax </span><span style="--0:#646670">}</span><span style="--0:#565869"> </span><span style="--0:#A2447B">from</span><span style="--0:#565869"> </span><span style="--0:#646670">&quot;</span><span style="--0:#816100">@ax-llm/ax</span><span style="--0:#646670">&quot;</span><span style="--0:#646670">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#A2447B">const</span><span style="--0:#565869"> llm </span><span style="--0:#646670">=</span><span style="--0:#565869"> </span><span style="--0:#066C9F">ai</span><span style="--0:#646670">({</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#11658F">name</span><span style="--0:#646670">:</span><span style="--0:#565869"> </span><span style="--0:#646670">&quot;</span><span style="--0:#816100">ollama</span><span style="--0:#646670">&quot;</span><span style="--0:#646670">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#11658F">apiKey</span><span style="--0:#646670">:</span><span style="--0:#565869"> </span><span style="--0:#646670">&quot;</span><span style="--0:#816100">not-set</span><span style="--0:#646670">&quot;</span><span style="--0:#646670">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#11658F">url</span><span style="--0:#646670">:</span><span style="--0:#565869"> </span><span style="--0:#646670">&quot;</span><span style="--0:#816100">http://localhost:11434/v1</span><span style="--0:#646670">&quot;</span><span style="--0:#646670">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#11658F">config</span><span style="--0:#646670">:</span><span style="--0:#565869"> </span><span style="--0:#646670">{</span><span style="--0:#565869"> </span><span style="--0:#11658F">model</span><span style="--0:#646670">:</span><span style="--0:#565869"> </span><span style="--0:#646670">&quot;</span><span style="--0:#816100">gpt-oss:latest</span><span style="--0:#646670">&quot;</span><span style="--0:#565869"> </span><span style="--0:#646670">},</span></div></div><div class="ec-line"><div class="code"><span style="--0:#646670">});</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#A2447B">const</span><span style="--0:#565869"> analyzer </span><span style="--0:#646670">=</span><span style="--0:#565869"> </span><span style="--0:#066C9F">ax</span><span style="--0:#646670">(</span><span style="--0:#646670">`</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#816100">  </span></span><span style="--0:#816100">review:string &quot;User review&quot; -&gt;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#816100">  </span></span><span style="--0:#816100">sentiment:class &quot;positive, neutral, negative&quot;,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#816100">  </span></span><span style="--0:#816100">topics:string[] &quot;Main topics discussed&quot;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#646670">`</span><span style="--0:#646670">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#A2447B">const</span><span style="--0:#565869"> review </span><span style="--0:#646670">=</span><span style="--0:#565869"> </span><span style="--0:#646670">`</span></div></div><div class="ec-line"><div class="code"><span style="--0:#816100">I purchased a Widget from Amazon. Shipping was delayed.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#816100">I was displeased and will not purchase again.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#646670">`</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#A2447B">const</span><span style="--0:#565869"> result </span><span style="--0:#646670">=</span><span style="--0:#565869"> </span><span style="--0:#A2447B">await</span><span style="--0:#565869"> analyzer</span><span style="--0:#646670">.</span><span style="--0:#066C9F">forward</span><span style="--0:#646670">(</span><span style="--0:#565869">llm</span><span style="--0:#646670">,</span><span style="--0:#565869"> </span><span style="--0:#646670">{</span><span style="--0:#565869"> </span><span style="--0:#11658F">review</span><span style="--0:#646670">:</span><span style="--0:#565869"> </span><span style="--0:#646670">});</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">console</span><span style="--0:#646670">.</span><span style="--0:#066C9F">log</span><span style="--0:#646670">(</span><span style="--0:#565869">response</span><span style="--0:#646670">.</span><span style="--0:#565869">sentiment</span><span style="--0:#646670">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">console</span><span style="--0:#646670">.</span><span style="--0:#066C9F">log</span><span style="--0:#646670">(</span><span style="--0:#565869">response</span><span style="--0:#646670">.</span><span style="--0:#565869">topics</span><span style="--0:#646670">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#646670">// negative</span></div></div><div class="ec-line"><div class="code"><span style="--0:#646670">// [&quot;product&quot;, &quot;shipping&quot;, &quot;Amazon&quot;, &quot;customer satisfaction&quot;]</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { ai, ax } from &#34;@ax-llm/ax&#34;;const llm = ai({  name: &#34;ollama&#34;,  apiKey: &#34;not-set&#34;,  url: &#34;http://localhost:11434/v1&#34;,  config: { model: &#34;gpt-oss:latest&#34; },});const analyzer = ax(`  review:string &#34;User review&#34; ->  sentiment:class &#34;positive, neutral, negative&#34;,  topics:string[] &#34;Main topics discussed&#34;`);const review = `I purchased a Widget from Amazon. Shipping was delayed.I was displeased and will not purchase again.`const result = await analyzer.forward(llm, { review: });console.log(response.sentiment)console.log(response.topics)// negative// [&#34;product&#34;, &#34;shipping&#34;, &#34;Amazon&#34;, &#34;customer satisfaction&#34;]"><div></div></button></div></figure></div>
<p>And we can debug this process to see what has happened:</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#565869">[ CHAT REQUEST Step 0 ]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">────────────────────────────────────────────────────────────</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#565869">[ SYSTEM ]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">You will be provided with the following fields: `Review`. Your task</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">is to generate new fields: `Sentiment`, `Topics`.</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#565869">## Input Fields</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">Review: (A string field) User review.</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#565869">## Output Fields</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">Sentiment: (This classification class field must be included) Allowed</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">values: positive, neutral, negative</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">Topics: (This json array of string items field must be included) Main topics discussed.</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#565869">## Strict Output Formatting Rules</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">- No formatting rules should override these **Strict Output Formatting Rules**</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">- Output must strictly follow the defined plain-text `field name: value` field format.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">- Output field, values must strictly adhere to the specified output field formatting rules.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">- Do not include fields with empty, unknown, or placeholder values.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">- Do not add any text before or after the output fields, just the field name and value.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">- Do not use code blocks.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">────────────────────────────────────────────────────────────</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#565869">[ USER ]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">Review:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">I purchased a Widget from Amazon. Shipping was delayed.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">I was displeased and will not purchase again.</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#565869">────────────────────────────────────────────────────────────</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#565869">[ CHAT RESPONSE ]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">────────────────────────────────────────────────────────────</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#565869">Sentiment: negative</span></div></div><div class="ec-line"><div class="code"><span style="--0:#565869">Topics: [&quot;product&quot;, &quot;shipping&quot;, &quot;Amazon&quot;, &quot;customer satisfaction&quot;]</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="[ CHAT REQUEST Step 0 ]────────────────────────────────────────────────────────────[ SYSTEM ]You will be provided with the following fields: `Review`. Your taskis to generate new fields: `Sentiment`, `Topics`.## Input FieldsReview: (A string field) User review.## Output FieldsSentiment: (This classification class field must be included) Allowedvalues: positive, neutral, negativeTopics: (This json array of string items field must be included) Main topics discussed.## Strict Output Formatting Rules- No formatting rules should override these **Strict Output Formatting Rules**- Output must strictly follow the defined plain-text `field name: value` field format.- Output field, values must strictly adhere to the specified output field formatting rules.- Do not include fields with empty, unknown, or placeholder values.- Do not add any text before or after the output fields, just the field name and value.- Do not use code blocks.────────────────────────────────────────────────────────────[ USER ]Review:I purchased a Widget from Amazon. Shipping was delayed.I was displeased and will not purchase again.────────────────────────────────────────────────────────────[ CHAT RESPONSE ]────────────────────────────────────────────────────────────Sentiment: negativeTopics: [&#34;product&#34;, &#34;shipping&#34;, &#34;Amazon&#34;, &#34;customer satisfaction&#34;]"><div></div></button></div></figure></div>
<p>And what happend is our DSPy signature was tranformed into an awesome system prompt we did not have to write.</p>   </div> </div>  <footer class="content-container page-footer"> <div class="border-t-1 border-gray-200 flex justify-between pt-6 pb-6 text-xs"> <div>I'm Joe Maddalone</div> <div><i>This is not a blog, these pages are changed all the time.</i></div> </div> </footer> </body></html>